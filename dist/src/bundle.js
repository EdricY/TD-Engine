!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/src/",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const n=540,o=18,s=Math.sqrt(2)/2;var r=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];const h=r.length,u=r[0].length;function l(t,e){return!(t>=u)&&(!(t<0)&&(!(e>=h)&&!(e<0)))}function a(t,e){return r[t][e]}const f=2*Math.PI;function c(t,e,i=8,n){this.x=t,this.y=e,this.r=i,this.vx=0,this.vy=0,this.maxv=1,this.color="cyan",Math.random()<.1&&(this.color="magenta"),this.selected=!1,this.field=n,this.getLocation=function(){return{x:this.x,y:this.y}},this.contains=function(t,e){return!(Math.abs(this.x-t)>this.r)&&!(Math.abs(this.y-e)>this.r)},this.draw=function(t){if(t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.r,0,f),t.fill(),this.selected){t.strokeStyle="yellow";let e=t.lineWidth;t.lineWidth=4,t.stroke(),t.lineWidth=e}},this.getFieldVector=function(t,e){let i={x:0,y:0};return l(t,e)&&(i=0==r[t][e]?this.field[t][e]:{x:this.x-(o*e+9),y:this.y-(o*t+9)}),i},this.update=function(){let t=Math.floor((this.x-this.r)/o),e=Math.floor((this.y-this.r)/o),i=Math.ceil((this.x-this.r)/o),n=Math.ceil((this.y-this.r)/o),s=this.getFieldVector(e,t),r=this.getFieldVector(e,i),h=this.getFieldVector(n,t),u=this.getFieldVector(n,i),l=(this.x-this.r)/o-t,a=s.x*(1-l)+r.x*l,f=s.y*(1-l)+r.y*l,c=h.x*(1-l)+u.x*l,y=h.y*(1-l)+u.y*l,v=(this.y-this.r)/o-e,g=a*(1-v)+c*v,x=f*(1-v)+y*v,b=Math.sqrt(g*g+x*x);d(b,0)||(this.vx=.8*g/b+(1-.8)*this.vx,this.vy=.8*x/b+(1-.8)*this.vy),this.vx*=this.maxv,this.vy*=this.maxv,this.x+=this.vx,this.y+=this.vy}}function d(t,e){return Math.abs(t-e)<=.01}function y(){this.values=[],this.enqueue=function(t){this.values.push(t)},this.getMinIndex=function(){if(this.values.length>0){let t=this.values[0].cost,e=0;for(let i=1;i<this.values.length;i++)this.values[i].cost<t&&(t=this.values[i].cost,e=i);return e}return-1},this.dequeue=function(){let t=this.getMinIndex();return this.values.splice(t,1)[0]},this.getLength=function(){return this.values.length},this.isEmpty=function(){return 0==this.values.length}}function v(t,e,i){var n,o;this.i=t,this.j=e,this.cost=0,this.fromNode=i,this.v={x:0,y:0},i&&(0==r[t][e]?(this.v={x:i.j-this.j,y:i.i-this.i},o=i,(n=this).i!=o.i&&n.j!=o.j&&(this.v.x*=s,this.v.y*=s)):this.v={x:0,y:0},this.cost=function(t,e,i,n){let o=a(t,e),s=a(i,n);return 1e3*Math.abs(o-s)+function(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))}(t,e,i,n)}(i.i,i.j,this.i,this.j),this.cost+=i.cost),this.compareTo=function(t){let e=this.cost,i=t.cost;return e<i?-1:e>i?1:0},this.addNeighbor=function(t,e,i){let n=this.i+t,o=this.j+e;l(n,o)&&i.push(new v(n,o,this))},this.neighbors=function(){let t=[];return this.addNeighbor(0,-1,t),this.addNeighbor(1,0,t),this.addNeighbor(0,1,t),this.addNeighbor(-1,0,t),this.addNeighbor(-1,-1,t),this.addNeighbor(1,-1,t),this.addNeighbor(-1,1,t),this.addNeighbor(1,1,t),t}}function g(t,e){return function(t,e){let i=[];for(let t=0;t<r.length;t++){i.push([]);for(let e=0;e<r[0].length;e++)i[t].push(null)}let n=new y,o=new v(t,e,null);for(n.enqueue(o);!n.isEmpty();){let t=n.dequeue();if(null!=i[t.i][t.j])continue;i[t.i][t.j]=t.v;let e=t.neighbors();for(let t of e)null==i[t.i][t.j]&&n.enqueue(t)}return i}(t,e)}document.getElementById("body");var x=document.getElementById("start-btn"),b=document.getElementById("canvas"),M=b.getContext("2d"),m={},p=0,w=0,j={j:u-1,i:h-1};b.width=n,b.height=n;var k,S={units:[]};function q(){M.fillStyle="#333",M.fillRect(0,0,n,n),M.strokeStyle="#555";for(let e=0;e<30;e++)for(let i=0;i<30;i++){let n=0==(t=r[e][i])?"black":1==t?"red":"white";M.fillStyle=n,M.fillRect(i*o,e*o,o,o),M.strokeRect(i*o,e*o,o,o)}var t;k&&function(t,e){for(let i=0;i<30;i++)for(let n=0;n<30;n++){if(!e[i][n])continue;t.strokeStyle="white",t.lineWidth=2,t.beginPath();let s=n*o+9,r=i*o+9;t.moveTo(s-o/8*e[i][n].y,r+o/8*e[i][n].x),t.lineTo(s+4.5*e[i][n].x,r+4.5*e[i][n].y),t.lineTo(s+o/8*e[i][n].y,r-o/8*e[i][n].x),t.stroke()}}(M,k),S.units.forEach(t=>t.draw(M))}function N(){S.units.forEach(t=>t.update()),function(t){for(let e=0;e<t.length;e++){let i=t[e];for(let n=e+1;n<t.length;n++){let e=t[n],s=e.x-i.x;if(Math.abs(s)>o)continue;let r=e.y-i.y;if(Math.abs(r)>o)continue;let h=Math.sign(s)*(o-Math.abs(s)),u=Math.sign(r)*(o-Math.abs(r));e.vx+=.2*h,e.vy+=.2*u,i.vx-=.2*h,i.vy-=.2*u}}}(S.units)}window.player=S,x.addEventListener("click",(function(){k=g(j.i,j.j);for(let t=0;t<8;t++){let t=Math.floor((Math.random()+p)*o),e=Math.floor((Math.random()+w)*o);S.units.push(new c(t,e,8,k))}})),requestAnimationFrame((function t(e){q(),N(),requestAnimationFrame(t)}));function E(t){let e=b.width/b.clientWidth;return Math.round(t*e)}b.onmousedown=function(t){m[t.button]=!0;let e=Math.round(E(t.offsetX)),i=Math.round(E(t.offsetY)),n=Math.floor(i/o),s=Math.floor(e/o);if(0===t.button){let t=function(t,e,i){for(let n of t.units)if(n.contains(e,i))return n;return null}(S,e,i);if(null!==t)return void(t.selected=!0);l(n,s)&&(r[n][s]=1)}else 2===t.button&&l(n,s)&&(r[n][s]=0)},b.onmousemove=function(t){let e=Math.round(E(t.offsetX)),i=Math.round(E(t.offsetY)),n=Math.floor(i/o),s=Math.floor(e/o);1==m[0]?l(n,s)&&(r[n][s]=1):1==m[2]&&l(n,s)&&(r[n][s]=0)},b.onmouseup=function(t){m[t.button]=!1},b.oncontextmenu=function(t){t.preventDefault()},window.onresize=function(t){b.width=n,b.height=n},window.onkeydown=function(t){m[t.keyCode]=!0},window.onkeyup=function(t){m[t.keyCode]=!1}}]);